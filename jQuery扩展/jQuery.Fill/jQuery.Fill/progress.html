<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>上传进度条测试</title>
    <link href="Content/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <h1>上传进度条</h1>

        <form>
            <div class="form-group">
                <label>name:</label>
                <input class="form-control" type="text" name="name" />
            </div>
            <!--<div class="form-group">
                <label>file:</label>
                <input class="form-control" type="file" name="file" />
            </div>-->
            <div class="progress">
                <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0">
                    <span class="sr-only">0% Complete (success)</span>
                </div>
            </div>
            <div class="clearfix">
                <button type="button" class="btn">submit</button>
            </div>
        </form>
    </div>
    <script src="Scripts/jquery-1.10.2.min.js"></script>
    <script src="Scripts/jquery.fill.1.0.js"></script>
    <script>
        $(".btn").click(function () {
            var s = $('form'), ms = s.modelState(), p = $('.progress-bar');
            $.ajaxFormData('/home/File', {
                data: ms.model
                , progress:
                    function (e, xhr) {
                        var pe = e.loaded / e.total * 100;
                        p.width(pe + '%').attr('aria-valuenow', pe).children('span').text(pe + '% Complete (success)');
                        //total,loaded;
                    }
                ,
                complete: function (xhr, txt, s) {

                    console.debug('complete');
                    console.debug(txt);
                    console.debug(s);
                }
                ,
                success: function (d, state, xhr) {

                    console.debug(d);
                    console.debug(state);
                    alert('success');
                }
                ,
                error: function (xhr,status,statusText) {
                    console.debug('error:');
                    console.debug(status);
                    console.debug(statusText);

                }

            })
            
        });
    </script>
</body>
</html>
